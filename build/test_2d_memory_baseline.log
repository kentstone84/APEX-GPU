
╔═══════════════════════════════════════════════════════════════╗
║            CUDA 2D Memory Operations Test                     ║
╚═══════════════════════════════════════════════════════════════╝

1. Allocating 2D pitched device memory...
   Requested width: 4096 bytes (1024 floats)
   Allocated pitch: 4096 bytes
   Height:          512 rows
   Pitch alignment: 0 bytes
   ✓ Pitch allocation successful

2. Allocating host memory...
3. Initializing test data...
   ✓ 524288 elements initialized

4. Testing cudaMemcpy2D (Host → Device)...
   ✓ 2D copy H2D completed
   Source pitch: 4096 bytes
   Dest pitch:   4096 bytes

5. Launching 2D kernel...
   Grid:  64 x 32 blocks
   Block: 16 x 16 threads
   ✓ 2D kernel completed

6. Testing cudaMemcpy2D (Device → Host)...
   ✓ 2D copy D2H completed

7. Verifying computation results...
   ✓ All 524288 elements verified correctly

8. Testing edge cases...
   ✓ Top-left corner [0,0]: 0.00 ✓
   ✓ Top-right corner [1023,0]: 3069.00 ✓
   ✓ Bottom-left corner [0,511]: 1533.00 ✓
   ✓ Bottom-right corner [1023,511]: 4602.00 ✓
   ✓ Center [512,256]: 2304.00 ✓

9. Testing multiple 2D arrays...
   ✓ Array 1 pitch: 4096 bytes
   ✓ Array 2 pitch: 4096 bytes
   ✓ Array 3 pitch: 4096 bytes
   ✓ Multiple 2D arrays processed successfully

10. Cleaning up resources...
   ✓ All memory freed

╔═══════════════════════════════════════════════════════════════╗
║                    2D MEMORY TEST RESULTS                     ║
╠═══════════════════════════════════════════════════════════════╣
║  Matrix size:        1024 x  512                              ║
║  Total elements:       524288                                    ║
║  Memory pitch:       4096 bytes                              ║
║  Pitch overhead:     0 bytes                              ║
║  Computation errors: 0                                        ║
║  Edge cases:         PASS                                    ║
╚═══════════════════════════════════════════════════════════════╝

╔═══════════════════════════════════════════════════════════════╗
║              ✅ ALL 2D MEMORY TESTS PASSED                   ║
╠═══════════════════════════════════════════════════════════════╣
║  • cudaMallocPitch                                            ║
║  • cudaMemcpy2D (H2D and D2H)                                 ║
║  • Pitched memory access in kernels                           ║
║  • Multiple 2D arrays                                         ║
║  • Edge case handling                                         ║
╚═══════════════════════════════════════════════════════════════╝

